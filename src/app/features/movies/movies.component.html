<div class="workspace-layout grid-system">
    <div class="workspace-main">
        <header class="ws-header">
            <div class="workspace-header-title">
                <h1>Popular Movies</h1>
            </div>

            <div class="ws-controls">
                <div class="filter-row-figma">
                    <div class="filter-group-left">
                        <app-figma-select title="Sort" [options]="sortOptions" [value]="filters().sortBy"
                            defaultValue="popularity.desc" (valueChange)="updateFilter('sortBy', $event)">
                        </app-figma-select>
                    </div>

                    <div class="filter-group-right">
                        <app-figma-select title="Genre" [options]="genreOptions()" [value]="filters().genreId"
                            (valueChange)="updateFilter('genreId', $event)">
                        </app-figma-select>

                        <app-figma-select title="Year" [options]="yearOptions()" [value]="filters().year"
                            (valueChange)="updateFilter('year', $event)">
                        </app-figma-select>

                        <app-figma-select title="Rating" [options]="ratingOptions" [value]="filters().minRating"
                            (valueChange)="updateFilter('minRating', $event)">
                        </app-figma-select>

                        <app-figma-select title="Language" [options]="languageOptions()" [value]="filters().language"
                            [alignRight]="true" (valueChange)="updateFilter('language', $event)">
                        </app-figma-select>
                    </div>
                </div>
            </div>
        </header>

        @if (isLoading()) {
        <app-loader></app-loader>
        }

        @if (errorMessage()) {
        <div class="error-container-figma card-flat">
            <p>{{ errorMessage() }}</p>
        </div>
        }

        <div class="ws-grid-inner">
            @for (movie of movies(); track movie.id) {
            <app-movie-card [movie]="movie" type="movie"></app-movie-card>
            }
        </div>

        @if (movies().length > 0) {
        <div class="load-more-container">
            <button class="btn-figma btn-outline-figma load-more-btn" [disabled]="isLoadingMore()" (click)="loadMore()">
                @if (isLoadingMore()) {
                <div class="spinner-tiny"></div>
                CALIBRATING...
                } @else {
                LOAD MORE MOVIES
                }
            </button>
        </div>
        }
    </div>
</div>